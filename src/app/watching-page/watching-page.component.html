<div class="watch-container">
<!-- Add this at the top of your template, right after opening watch-container -->
<div class="focus-mode-overlay" 
     [class.active]="isFocusMode" 
     (click)="exitFocusMode()"></div>
  <div class="watch-layout">
    <!-- Episode Sidebar (Only for TV Shows) -->
    <div>
      <p-button label="Back" icon="pi pi-arrow-left" routerLink="/homepage" />
    </div>

    <div class="sidebar-wrapper">
      <div class="sidebar">
        <div class="select-section">
          @if(seasonOptions.length > 0) {
          <p-select
            [options]="seasonOptions"
            [(ngModel)]="selectedSeason"
            placeholder="Select Season"
            (onChange)="onSeasonChange($event.value)"
            optionLabel="label"
            optionValue="value"
            styleClass="custom-select"
          ></p-select>
          } @else {
          <!-- Season shimmer loading -->
          <p-skeleton width="40%" height="40px" borderRadius="6px"></p-skeleton>
          }
        </div>
        <ul class="list-section">
          @if(isTVShow) { @if(episodeOptions.length > 0) { @for (ep of
          episodeOptions; track ep; let i = $index) {
          <li
            class="boxed-episode"
            [class.active]="selectedEpisode === ep.value"
            (click)="onEpisodeSelect(ep)"
          >
            {{ i + 1 }}
          </li>
          } } @else if(seasonOptions.length > 0) {
          <!-- Episodes shimmer loading (when seasons are loaded but episodes aren't) -->
          @for (item of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,34,4,34,3,4];
          track item) {
          <li class="boxed-episode-shimmer">
            <p-skeleton
              width="80%"
              height="35px"
              borderRadius="6px"
            ></p-skeleton>
          </li>
          } } @else {
          <!-- Both seasons and episodes shimmer loading -->
          @for (item of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,34,4,34,3,4];
          track item) {
          <li class="boxed-episode-shimmer">
            <p-skeleton
              width="80%"
              height="35px"
              borderRadius="6px"
            ></p-skeleton>
          </li>
          } } } @else {
          <li class="boxed-episode" [class.active]="true">1</li>
          }
        </ul>
      </div>
    </div>
    <!-- Main Content Area -->
    <div class="main-content">
      <div class="player-and-controls">
        <!-- Video Player Section -->
        <div class="player-section">
          <div class="player-wrapper" [class.focus-mode-active]="isFocusMode">
            <div #container class="yt-container">
              <youtube-player
                #ytPlayer
                [videoId]="trailerKey"
                [width]="videoWidth"
                [height]="videoHeight"
                (stateChange)="onPlayerStateChange($event)"
                (ready)="onPlayerReady()"
                [playerVars]="playerVars"
              ></youtube-player>
            </div>
          </div>
        </div>

        <!-- Player Controls -->
        <div class="player-controls">
          <div class="control-buttons">
            <button class="control-btn">
              <i class="pi pi-stop"></i> Auto Play
            </button>
            <button class="control-btn">
              <i class="pi pi-stop"></i>Auto Next
            </button>
            <button class="control-btn">
              <i class="pi pi-stop"></i>Auto Skip
            </button>
            <button class="control-btn" (click)="toggleFocusMode()">
              <i
                class="pi"
                [ngClass]="{
                  'pi-lightbulb': !isFocusMode,
                  'pi-moon': isFocusMode
                }"
              ></i>
            </button>
            <button
              class="control-btn"
              (click)="prevEpisode()"
              pTooltip="Press B to skip backward an episode."
              tooltipPosition="top"
            >
              <i class="pi pi-step-backward"></i> Prev
            </button>
            <button
              class="control-btn"
              (click)="nextEpisode()"
              pTooltip="Press N to skip forward an episode."
              tooltipPosition="top"
            >
              <i class="pi pi-step-forward"></i> Next
            </button>
          </div>
        </div>
      </div>
      <div class="selected-episode-name mt-3">{{ selectedEpisodeName }}</div>
    </div>

    <!-- Related Section -->
    <div class="related-section">
      <div class="related-title">Related</div>
      <!-- You would add related content components here -->
    </div>
  </div>
</div>
